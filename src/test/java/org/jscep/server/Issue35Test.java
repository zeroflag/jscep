package org.jscep.server;

import org.junit.Test;
import org.junit.Assert;
import org.bouncycastle.util.encoders.Base64;
import org.bouncycastle.cms.CMSSignedData;

public class Issue35Test {
    private static String TEST_STRING = "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";
      
    @Test
    public void testIssue35() throws Exception {
        byte[] msgBytes = Base64.decode(TEST_STRING);
        CMSSignedData sd;
        try {
            sd = new CMSSignedData(body);
        } catch (CMSException e) {
            Assert.fail("Message from GitHub issue 35 failed.");
        }
    }
}
